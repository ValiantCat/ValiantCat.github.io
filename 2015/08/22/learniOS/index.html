<!DOCTYPE html>
<!--[if lte IE 8 ]>
<html class="ie" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<!--
***************  *      *     *
      8          *    *       *
      8          *  *         *
      8          **           *
      8          *  *         *
      8          *    *       *
      8          *      *     *
      8          *        *   ***********    -----Theme By Kieran(http://go.kieran.top)
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">
<!--<![endif]-->

<head>
  <title>寒哥教你学iOS - 经验漫谈 | 茶茶的小屋</title>
  <!-- Meta data -->
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="茶茶的小屋">
    <meta name="author" content="寒哥">
    <meta name="description" content="iOS 开发， Swift，Objective-C,OC" />
    <meta name="keywords" content="" />

    <!-- Favicon, (keep icon in root folder) -->
    <link rel="Shortcut Icon" href="/img/favicon.ico" type="image/ico">

    <link rel="alternate" href="/atom.xml" title="茶茶的小屋" type="application/atom+xml">
    <link rel="stylesheet" href="/css/all.css" media="screen" type="text/css">
	
    <link rel="stylesheet" href="/highlightjs/github.css" type="text/css">
    


    <!-- Custom stylesheet, (add custom styles here, always load last) -->
    <!-- Load our stylesheet for IE8 -->
    <!--[if IE 8]>
    <link rel="stylesheet" type="text/css" href="/css/ie8.css" />
    <![endif]-->

    <!-- Google Webfonts (Monserrat 400/700, Open Sans 400/600) -->
    <!-- <link href='//fonts.useso.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'> -->
    <!-- <link href='//fonts.useso.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'> -->

    <!-- Load our fonts individually if IE8+, to avoid faux bold & italic rendering -->
    <!--[if IE]>
    <link href='http://fonts.useso.com/css?family=Montserrat:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Montserrat:700' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.useso.com/css?family=Open+Sans:600' rel='stylesheet' type='text/css'>
    <![endif]-->

    <!-- jQuery | Load our jQuery, with an alternative source fallback to a local version if request is unavailable -->
    <script src="/js/jquery-1.11.1.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery-1.11.1.min.js"><\/script>')</script>

    <!-- Load these in the <head> for quicker IE8+ load times -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="/js/html5shiv.min.js"></script>
    <script src="/js/respond.min.js"></script>
    <![endif]-->










  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  
  <style>.col-md-8.col-md-offset-2.opening-statement img{display:none;}</style>
</head>

<!--
<body class="post-template">
-->
<body id="index" class="lightnav animsition">

      <!-- ============================ Off-canvas navigation =========================== -->

    <div class="sb-slidebar sb-right sb-style-overlay sb-momentum-scrolling">
        <div class="sb-close" aria-label="Close Menu" aria-hidden="true">
            <img src="/img/close.png" alt="Close"/>
        </div>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu">
            <li><a href="/" class="animsition-link" title="Home">Home</a></li>
            <li><a href="/archives" class="animsition-link" title="archive">archives</a></li>
            <!-- Dropdown Menu -->
			 
            
            
            <li>
                <a class="sb-toggle-submenu">Links<span class="sb-caret"></span></a>
                <ul class="sb-submenu">
                    
                    <li><a href="http://www.jianshu.com/users/cc1e4faec5f7" class="animsition-link">寒哥的简书</a></li>
                    
                    <li><a href="http://blog.csdn.net/xinxinqiu" class="animsition-link">寒哥的CSDN</a></li>
                    
                    <li><a href="https://github.com/aiqiuqiu" class="animsition-link">寒哥的Github</a></li>
                    
                </ul>
            </li>
            
        </ul>
        <!-- Lists in Slidebars -->
        <ul class="sb-menu secondary">
            <li><a href="/about.html" class="animsition-link" title="about">About</a></li>
            <li><a href="/atom.xml" class="animsition-link" title="rss">RSS</a></li>
        </ul>
    </div>
    
    <!-- ============================ END Off-canvas navigation =========================== -->

    <!-- ============================ #sb-site Main Page Wrapper =========================== -->

    <div id="sb-site">
        <!-- #sb-site - All page content should be contained within this id, except the off-canvas navigation itself -->

        <!-- ============================ Header & Logo bar =========================== -->

        <div id="navigation" class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <!-- Nav logo -->
                    <div class="logo">
                        <a href="/" title="Logo" class="animsition-link">
                         <img src="/img/logo.png" alt="Logo" width="35px;"/> 
                        </a>
                    </div>
                    <!-- // Nav logo -->
                    <!-- Info-bar -->
                    <nav>
                        <ul class="nav">
                            <li><a href="/" class="animsition-link">茶茶的小屋</a></li>
                            <li class="nolink"><span>Always </span>Creative.</li>
                            
                            <li><a href="https://github.com/aiqiuqiu" title="Github" target="_blank"><i class="icon-github"></i></a></li>
                            
                            
                            <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a></li>
                            
                            
                            <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a></li>
                            
                            
                            <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a></li>
                            
                            
                            <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a></li>
                            
                            <li class="nolink"><span>Welcome!</span></li>
                        </ul>
                    </nav>
                    <!--// Info-bar -->
                </div>
                <!-- // .container -->
                <div class="learnmore sb-toggle-right">More</div>
                <button type="button" class="navbar-toggle menu-icon sb-toggle-right" title="More">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar before"></span>
                <span class="icon-bar main"></span>
                <span class="icon-bar after"></span>
                </button>
            </div>
            <!-- // .navbar-inner -->
        </div>

        <!-- ============================ Header & Logo bar =========================== -->

        <!-- ============================ Hero Image =========================== -->

        <section id="hero" class="scrollme">
            <div class="container-fluid element-img" style="background: url(/img/bg_img.jpg) no-repeat center center fixed;background-size: cover">
                <div class="row">
                    <div class="col-xs-12 col-sm-8 col-sm-offset-2 col-md-8 col-md-offset-2 vertical-align cover boost text-center">
                        <div class="center-me animateme" data-when="exit" data-from="0" data-to="0.6" data-opacity="0" data-translatey="100">
                            <div>
                            	
                                <h2>YOU'VE MADE A <span>BRAVE</span> DECISION, WELCOME.</h2>
                                <p></p>
				    			
                                <h2></h2>
                                <p>每一个不曾起舞的日子都是对生命的辜负。</p>
				    			

                            </div>
                        </div>
                    </div>
                    <!-- // .col-md-12 -->
                </div>
                <div class="herofade beige-dk"></div>
            </div>
        </section>

        <!-- Height spacing helper -->
        <div class="heightblock"></div>
        <!-- // End height spacing helper -->

        <!-- ============================ END Hero Image =========================== -->
      
<section id="intro">
    <div class="container">
        <div class="row col-md-offset-2">
            <div class="col-md-8">
    			<span class="post-meta">
      <time datetime="2015-08-22T06:23:13.000Z" itemprop="datePublished">
          2015-08-22
      </time>
    
    
    | 
    <a href='/tags/iOS/'>iOS</a>
    
    
</span>
                <h1>寒哥教你学iOS - 经验漫谈</h1>
            </div>
        </div>
        <div class="col-md-8 col-md-offset-2">
      		<ul>
<li>本篇文章主要讲解 4个问题</li>
</ul>
<ol>
<li>load妙用</li>
<li>aop面向切面编程</li>
<li>NSNumber Or  Int </li>
<li>@()适配64位</li>
</ol>
<hr>
<p>##1  让appDelegate 减少负担 </p>
<blockquote>
<p>经过漫长时间的学习 你终于掌握了iOS大法 你找到了份iOS开发的工作   信誓旦旦的要开始你的coding生涯   老板对你非常器重  然后告诉你  我觉得你的技术 是非常刁的  那这个项目就你自己来搞吧   啊哦这就意味着这个项目你就从头到尾处理  从软件的架构 到页面的展示 都交给你喽 😨</p>
</blockquote>
<p> 用着自己的半吊子水平 papapa的  coding    决心一定要把代码封装好 写的漂亮 （其实是听大神说 封装  其实自己不太懂）<br>  项目到了尾声   老板告诉你我们的app  我们的app 将来得来个分享到朋友圈的功能吧  不然怎么体现我产品的牛逼<br>然后你听说友盟比较好使（有广告的嫌疑）  你去友盟看了他们的文档 他告诉你你要在  appdelegate  didFinishLaunch方法里面写了这个东西<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">[UMSocialData setAppKey:@<span class="string">"XX"</span>];</div><div class="line">   <span class="comment">//     注册微信</span></div><div class="line"></div><div class="line">[UMSocialWechatHandler setWXAppId:@<span class="string">"XXX"</span>  appSecret:@<span class="string">"XX"</span> url:@<span class="string">""</span>];</div><div class="line">   <span class="comment">//    注册QQ</span></div><div class="line"> </div><div class="line">[UMSocialQQHandler setQQWithAppId:@<span class="string">"XXX"</span> appKey:@<span class="string">"XXX"</span> url:@<span class="string">""</span>];</div></pre></td></tr></table></figure></p>
<p>过了几天 老板又说 我们需要统计下我页面的信息  你接入了友盟的统计  在appdelegate didFinishLaunch又 多了行代码</p>
<p>需求是无穷无尽   我需要bug统计（fir hud） 提醒用户评分系统（iRate） 推送（jPush  信鸽 个推。。）<br>当初你决心一定要把代码封装的完美 写的漂亮的心早就被老板的需求彻底打败了<br>别担心 寒哥教你小技巧 </p>
<p>不知道你们用过 <a href="https://github.com/hackiftekhar/IQKeyboardManager" target="_blank" rel="external">IQKeyBoardManage</a>和<a href="https://github.com/nicklockwood/iRate" target="_blank" rel="external">iRate</a>这种智能库没</p>
<p>大牛的readme 写了这段话</p>
<blockquote>
<p>Key Features<br>1) <strong>CODELESS</strong>, Zero Line Of Code  不需要写任何代码</p>
<p>2) Works Automatically  //自动工作</p>
<p>3) No More UIScrollView //不需要scrollview</p>
<p>4) No More Subclasses  //不需要继承父类</p>
<p>5) No More Manual Work //不需要配置</p>
<p>6) No More #imports   //不需要导入</p>
</blockquote>
<p>其实不神奇 只是大牛用了 + load这个方法<br>学习OC都知道这个代码会在一个类被加载到运行库中就会被自动调用 这不就实现了  自动调用 </p>
<p>写一个类继承自NSObject </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line">@interface ThirdPartService : NSObject</div><div class="line"></div><div class="line">@end</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> <span class="meta">#import <span class="meta-string">"ThirdPartService.h"</span></span></div><div class="line"> <span class="meta">#import <span class="meta-string">"UMSocial.h"</span></span></div><div class="line"> <span class="meta">#import <span class="meta-string">"UMSocialWechatHandler.h"</span></span></div><div class="line"> <span class="meta">#import <span class="meta-string">"UMSocialQQHandler.h"</span></span></div><div class="line"> <span class="meta">#import <span class="meta-string">&lt;MobClick.h&gt;</span></span></div><div class="line"> <span class="meta">#import <span class="meta-string">&lt;FIR/FIR.h&gt;</span></span></div><div class="line"></div><div class="line">@implementation ThirdPartService</div><div class="line"> + (<span class="keyword">void</span>)load &#123;</div><div class="line"><span class="keyword">static</span> <span class="keyword">dispatch_once_t</span> onceToken;</div><div class="line">dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">    <span class="comment">//    TODO  这里是我自己测试的  fir hud</span></div><div class="line">    [FIR handleCrashWithKey:@<span class="string">"XX"</span>];</div><div class="line">    <span class="comment">//    友盟</span></div><div class="line">    [UMSocialData setAppKey:@<span class="string">"XX"</span>];</div><div class="line">    <span class="comment">//     隐藏未安装的平台</span></div><div class="line">    [UMSocialConfig hiddenNotInstallPlatforms:@[UMShareToQQ,UMShareToQzone,UMShareToWechatSession,UMShareToWechatTimeline]];</div><div class="line">    <span class="comment">//     注册微信</span></div><div class="line">    [UMSocialWechatHandler setWXAppId:@<span class="string">"XX"</span> appSecret:@<span class="string">"XX"</span> url:@<span class="string">""</span>];</div><div class="line">    <span class="comment">//    注册QQ</span></div><div class="line">    <span class="comment">//    TODO   QQ的不是真的</span></div><div class="line">    [UMSocialQQHandler setQQWithAppId:@<span class="string">"XX"</span> appKey:@<span class="string">"XX"</span> url:@<span class="string">""</span>];</div><div class="line">    </div><div class="line">    <span class="comment">//    TODO    UM统计</span></div><div class="line">    [MobClick startWithAppkey:@<span class="string">""</span>];</div><div class="line">    [MobClick setCrashReportEnabled:NO];</div><div class="line">    NSLog(@<span class="string">"第三方服务注册完毕"</span>);</div><div class="line">&#125;);</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>类似于定位也可以这样写</p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/1.png" alt="1"></p>
<p>模块和服务完全拆开   </p>
<p>但是有的服务 如APNS需要LaunchOption 那就只能写在appdDelegate 不过这样的话已经摘除很多代码了  只剩下几个固定的 到时候再修改appDelegate就会感觉非常清晰 了 </p>
<hr>
<p>##2   ViewController继承？</p>
<p>接着上面讲  我们接入了友盟统计  友盟统计最基本的东西就是 统计页面的pv </p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/2.png" alt="Paste_Image.png"></p>
<p>友盟的这样写  对于新手的我们就觉得这不就so easy吗<br>我打开了某个vc（HomeViewController）<br>在代码里面写上了这句<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">-(<span class="keyword">void</span>)viewWillAppear:(BOOL)animated &#123;</div><div class="line">   [super viewWillAppear:animated];</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> DEBUG</span></div><div class="line">   [MobClick beginLogPageView:NSStringFromClass([self <span class="keyword">class</span>])];</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">&#125;</div><div class="line">-(<span class="keyword">void</span>)viewWillDisappear:(BOOL)animated &#123;</div><div class="line">    [super viewWillDisappear:animated];</div><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> DEBUG</span></div><div class="line"></div><div class="line">  [MobClick endLogPageView:NSStringFromClass([self <span class="keyword">class</span>])];</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>然后我一个项目中可能有几十个 甚至上百个页面需要统计pv 我总不能每个节目都这样写吧  </p>
<p>聪明的我们想到了继承</p>
<p>如<code>MyBaseViewController:UIViewController</code><br>这样就要做一件事  把我们项目中所有继承自UIViewController的类全部改为继承自<code>MyBaseViewController</code>   然而你真的觉得这样好吗   我们一个项目中有几十个控制器  我就要把每个控制器改一遍  </p>
<p>这种重复性的工作一是无聊  而是容易出错   你复制着复制者就会遗漏掉某个类   重要的是 我们项目中很多类并不是直接继承自<code>UIViewController</code>  有的可能是<code>UITableViewController</code> <code>UICollectionViewContr0ller</code> <code>UINavigationController</code> 甚至不常用的<code>UISearchDisPlayController</code> <code>UIPopoverController</code>  <code>UIPresentController</code>  是不是突然觉得这么多啊啊  😨</p>
<p>这也不是坑的 坑的是将来你混成了大牛 招了个小弟  你告诉他你所有的类都要继承自我写的各种父类   新手总是会不经意见犯错误  有些类忘记继承了 后期查起来难度非常大 浪费时间 所以这种设计是不合理的  </p>
<ul>
<li><p>寒哥再次教你黑魔法 Method  swizzling</p>
<p><strong>关于这个是干嘛的 自行百度</strong></p>
</li>
</ul>
<blockquote>
<p>这里有一篇来自NSHipster博主的文章 <a href="http://nshipster.com/method-swizzling/" target="_blank" rel="external">英文</a><br><a href="http://www.jianshu.com/p/b87fa689055f" target="_blank" rel="external">中文翻译</a><br>还有一篇解释runtime的文章<a href="http://www.jianshu.com/p/6b905584f536" target="_blank" rel="external">传送门</a><br><a href="http://tech.glowing.com/cn/method-swizzling-aop/" target="_blank" rel="external">实践</a></p>
</blockquote>
<p>用方法交叉 我们就可以拦截吸引的方法了 上代码了<br>这样就做到了面向切面编程（AOP）的思想</p>
<p>上代码<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#import &lt;UIKit/UIKit.h&gt;</div><div class="line"></div><div class="line">@interface UIViewController (AOP)</div><div class="line">#warning  运行时 改变一下方法 做一些切面编程比如 统计 等等</div><div class="line"> @end</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> #import "UIViewController+AOP.h"</div><div class="line"> #import &lt;objc/runtime.h&gt;</div><div class="line">#import &lt;MobClick.h&gt;</div><div class="line"> @implementation UIViewController (AOP)</div><div class="line"></div><div class="line"> + (void)load &#123;</div><div class="line">   static dispatch_once_t onceToken;</div><div class="line">  dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">    Class class = [self class];</div><div class="line">    // When swizzling a class method, use the following:</div><div class="line">    // Class class = object_getClass((id)self);</div><div class="line">    swizzleMethod(class, @selector(viewDidLoad), @selector(aop_viewDidLoad));</div><div class="line">    swizzleMethod(class, @selector(viewDidAppear:), @selector(aop_viewDidAppear:));</div><div class="line">    swizzleMethod(class, @selector(viewWillAppear:), @selector(aop_viewWillAppear:));</div><div class="line">    swizzleMethod(class, @selector(viewWillDisappear:), @selector(aop_viewWillDisappear:));</div><div class="line">&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"> void swizzleMethod(Class class, SEL originalSelector, SEL swizzledSelector)   &#123;</div><div class="line">Method originalMethod = class_getInstanceMethod(class, originalSelector);</div><div class="line">Method swizzledMethod = class_getInstanceMethod(class, swizzledSelector);</div><div class="line">BOOL didAddMethod =</div><div class="line">class_addMethod(class,</div><div class="line">                originalSelector,</div><div class="line">                method_getImplementation(swizzledMethod),</div><div class="line">                method_getTypeEncoding(swizzledMethod));</div><div class="line"></div><div class="line">if (didAddMethod) &#123;</div><div class="line">    class_replaceMethod(class,</div><div class="line">                        swizzledSelector,</div><div class="line">                        method_getImplementation(originalMethod),</div><div class="line">                        method_getTypeEncoding(originalMethod));</div><div class="line">&#125; else &#123;</div><div class="line">    method_exchangeImplementations(originalMethod, swizzledMethod);</div><div class="line">&#125;</div><div class="line"> &#125;</div><div class="line"> - (void)aop_viewDidAppear:(BOOL)animated &#123;</div><div class="line">[self aop_viewDidAppear:animated];</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"> -(void)aop_viewWillAppear:(BOOL)animated &#123;</div><div class="line">[self aop_viewWillAppear:animated];</div><div class="line"></div><div class="line">#ifndef DEBUG</div><div class="line">   [MobClick beginLogPageView:NSStringFromClass([self class])];</div><div class="line">#endif</div><div class="line">&#125;</div><div class="line"> -(void)aop_viewWillDisappear:(BOOL)animated &#123;</div><div class="line">    [self aop_viewWillDisappear:animated];</div><div class="line">#ifndef DEBUG</div><div class="line"></div><div class="line">    [MobClick endLogPageView:NSStringFromClass([self class])];</div><div class="line">#endif</div><div class="line">&#125;</div><div class="line"> - (void)aop_viewDidLoad &#123;</div><div class="line">[self aop_viewDidLoad];</div><div class="line"></div><div class="line">if ([self isKindOfClass:[UINavigationController class]]) &#123;</div><div class="line">    UINavigationController *nav = (UINavigationController *)self;</div><div class="line">    nav.navigationBar.translucent = NO;</div><div class="line">    nav.navigationBar.barTintColor = GLOBAL_NAVIGATION_BAR_TIN_COLOR;</div><div class="line">    nav.navigationBar.tintColor = [UIColor whiteColor];</div><div class="line">    NSDictionary *titleAtt = @&#123;NSForegroundColorAttributeName:[UIColor whiteColor]&#125;;</div><div class="line">    [[UINavigationBar appearance] setTitleTextAttributes:titleAtt];</div><div class="line">    [[UIBarButtonItem appearance]</div><div class="line">     setBackButtonTitlePositionAdjustment:UIOffsetMake(0, -60)</div><div class="line">     forBarMetrics:UIBarMetricsDefault];</div><div class="line">&#125;</div><div class="line"></div><div class="line">//    self.view.backgroundColor = [UIColor whiteColor];</div><div class="line">self.navigationController.interactivePopGestureRecognizer.delegate = (id&lt;UIGestureRecognizerDelegate&gt;)self;</div><div class="line"> &#125;</div><div class="line"> @end</div></pre></td></tr></table></figure></p>
<p>图片代码一份 方便观看</p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/3.png" alt="Paste_Image.png"><br><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/4.png" alt="Paste_Image.png"></p>
<p>我们充分利用了黑魔法达到了面向切面编程的好处 </p>
<p>思想来源这里<a href="">http://casatwy.com/iosying-yong-jia-gou-tan-viewceng-de-zu-zhi-he-diao-yong-fang-an.html</a></p>
<p><code>黑魔法非毒药 遵守一个规范写出来的代码是不会Crash的 只要能帮我们解决问题就是好东西</code><br> <code>黑魔法性能 有瓶颈？ 都到runtime的底层了 你还担心有瓶颈  少年安心使用就好了   不服 可以用Time Profiel测试</code><br><code>黑魔法也非万能  像 我们在导航控制器要封装手势 统一管理左侧返回按钮  这些东西 还是继承来得好</code></p>
<blockquote>
<p>技术就是工具  黑猫，白猫，抓住老鼠就是好猫</p>
</blockquote>
<hr>
<pre><code>华丽的分割线
</code></pre><hr>
<p>##3  网络访问参数到底用基本数据类型还是对象</p>
<p>下面看两个方法</p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/5.png" alt="Paste_Image.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"> + (<span class="keyword">void</span>)getDataAtPageNo:(NSNumber *)pageNo PageSize:(NSNumber *)pageSize </div><div class="line">complete:(CompleteBlock)complete &#123;</div><div class="line">NSMutableDictionary *param = [NSMutableDictionary dictionary];</div><div class="line">    <span class="keyword">if</span> (pageSize) &#123;</div><div class="line">        [param setObject:pageSize forKey:@<span class="string">"pageSize"</span>];</div><div class="line">   &#125;</div><div class="line"> [param setObject:pageNo forKey:@<span class="string">"pageNo"</span>];</div><div class="line"><span class="comment">// SendRequest</span></div><div class="line">&#125;</div><div class="line"> + (<span class="keyword">void</span>)getData2AtPageNo:(<span class="keyword">long</span> )pageNo PageSize:(<span class="keyword">long</span> )pageSize </div><div class="line"> complete:(CompleteBlock)complete &#123;</div><div class="line">     NSMutableDictionary *param = [NSMutableDictionary dictionary];</div><div class="line"></div><div class="line">        [param setObject:@(pageSize) forKey:@<span class="string">"pageSize"</span>];</div><div class="line">        [param setObject:@(pageNo) forKey:@<span class="string">"pageNo"</span>];</div><div class="line"><span class="comment">// SendRequest</span></div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<p>在访问网络请求时 对于有参数的请求 设计一个方法 主流为以上两种 </p>
<ol>
<li>使用对象当做参数</li>
<li>使用基本数据类型做参数</li>
</ol>
<p>一般情况下 这并没有什么大的区别   但是寒哥给出的意见是<code>Never</code>出现基本数据类型</p>
<p>一般情况下  开发者可能觉得并没有什么区别   下面我给大家举个例子</p>
<blockquote>
<p>在设计一个分页展示数据的时候：  在页面上的逻辑就是 默认加载第一页  每页长度为10 (Server端的同学一般都很友好 默认情况下 不传每页的长度就是10个) 但是传了就会覆盖掉后台写的默认参数 如传了20 Server就吐20条数据</p>
</blockquote>
<ol>
<li>在第一中设计方案中： 可能在某个控制器中保留一个PageNo PageSize 的<code>对象</code>的成员变量 ，在下拉刷新或者上拉加载的时候 会传递对应的参数给请求方法 ，  如果没有特殊需求的话pageSize 对象可有可无 也就是有可能为nil  ，那在对应的param可能就没有这个参数传递给Server  。<br>Server 就会交还给我们某页的20条数据 </li>
<li>在 第二种设计方案中 ： 可能也在某个控制器中保留一个PageNo pageSize的<code>基本数据类型</code>的成员变量，  在访问网络请求时交给对应的方法 ，     一般没有特殊需求我们也不会对PageSize专门设值  但是  基本数据类型在OC 和C语言这种传统的编程语言中是有默认值的 为<code>0</code>，虽然我们没有给pageSize 赋值 但是默认系统默认给了0这个初始值  那么传递到Server的时候 就会覆盖掉Server 写的默认pageSize=10   这样的请求既不会报错 也不会返回数据<br>超级难调试 </li>
</ol>
<p>所以在网络访问中 寒哥给出的意见就是<code>Never</code>出现基本数据类型</p>
<hr>
<p>##4 用NSNumber比基本数据类型的好处 ？ 64位适配问题<br> 我们一般都用来当做网络请求的参数  缓存或者展示到页面 </p>
<ol>
<li>对于网络请求的参数 因为NSDictionary只能放对象 所以NSNumber最好的方式</li>
<li>缓存  无论缓存到plist 还是KeyArchive 都是需要对象的所以NSNumber也非常合适<br>3 展示到页面<br>我见过这样给页面上赋值的朋友  </li>
</ol>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/6.png" alt="Paste_Image.png"></p>
<p>我们看到这样貌似并没有什么不妥<br>但是我们把设备切换到iPhone5S以下  也就是32位的设备</p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/7.png" alt="Paste_Image.png"><br>注意这里有Warning<br>为什么呢 我们来看下NSInteger的头文件 </p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/8.png" alt="Paste_Image.png"><br>在32下设备是Int  在64位是long<br>我们都知道苹果不允许不支持64位的app上架  但是貌似我们从来没有为32位和64位做适配</p>
<p>其实不然 在printf 和NSLog 时 对应%d %zd %f 占位符是非常严格的 如果不对项目就会造成意外的结果</p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/9.png" alt="Paste_Image.png"></p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/10.png" alt="Paste_Image.png"></p>
<p>其实拿到一个NSNumber我们并不知道他到底是int long  unsigned int  Bool  直接针对某个类型转换是有风险的  但是其实Clang 给我们提供了个非常好用的Macro <code>@()</code></p>
<p><img src="http://ompeszjl2.bkt.clouddn.com/learniOS/11.png" alt="Paste_Image.png"></p>
<p>NSNumber并不是一个简单的类 它是cocoa 中  类簇的实现参考资料<br><a href="http://www.cocoachina.com/ios/20140109/7681.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20140109/7681.html</a><br><a href="http://www.cocoachina.com/ios/20150106/10848.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20150106/10848.html</a><br><a href="http://www.cocoachina.com/ios/20141218/10688.html" target="_blank" rel="external">http://www.cocoachina.com/ios/20141218/10688.html</a></p>
<hr>

            <div class="clearfix"></div>
            <hr class="nogutter">
        </div>
        <nav class="pagination" role="pagination">
    
    <a class="pull-left" href="/2015/09/05/ContainerView/" style="float: left;">
        ← 友好的ContainerView&AutoLayout资料推荐
    </a>
    
    
    <a class="pull-right" href="/2015/08/03/SwiftVariables/">
        关于Swift  你可能连变量都不会定义 →
    </a>
    
</nav>

        <div class="duoshuo">
<div class="ds-thread" data-thread-key="2015/08/22/learniOS/" data-title="寒哥教你学iOS - 经验漫谈" data-url="http://valiantcat.com/2015/08/22/learniOS/"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"chachaHouse"};
(function() {
	var ds = document.createElement('script');
	ds.type = 'text/javascript';ds.async = true;
	ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
	ds.charset = 'UTF-8';
	(document.getElementsByTagName('head')[0] 
	 || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script>
</div>
    </div>
</section>


      
<!-- ============================ Footer =========================== -->

<footer>
    <div class="container">
            <div class="copy">
                <p>
                    &copy; 2014<script>new Date().getFullYear()>2010&&document.write("-"+new Date().getFullYear());</script>, Content By 寒哥. All Rights Reserved.
                </p>
                <p>Theme By <a href="//go.kieran.top" style="color: #767D84">Kieran</a></p>
            </div>
            <div class="social">
                <ul>
                    
                    <li><a href="https://github.com/aiqiuqiu" title="Github" target="_blank"><i class="icon-github"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://twitter.com/" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://www.facebook.com/" title="Facebook" target="_blank"><i class="icon-facebook"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="https://google.com/" title="Google-Plus" target="_blank"><i class="icon-google-plus"></i></a>&nbsp;</li>
                    
                    
                    <li><a href="http://weibo.com/" title="Sina-Weibo" target="_blank"><i class="icon-sina-weibo"></i></a>&nbsp;</li>
                    
                </ul>
            </div>
            <div class="clearfix"> </div>
        </div>
</footer>

<!-- ============================ END Footer =========================== -->
      <!-- Load our scripts -->
        
<!-- Resizable 'on-demand' full-height hero -->
<script type="text/javascript">
    
    var resizeHero = function () {
        var hero = $(".cover,.heightblock"),
            window1 = $(window);
        hero.css({
            "height": window1.height()
        });
    };
    
    resizeHero();
    
    $(window).resize(function () {
        resizeHero();
    });
</script>
<script src="/js/plugins.min.js"></script><!-- Bootstrap core and concatenated plugins always load here -->
<script src="/js/jquery.flexslider-min.js"></script><!-- Flexslider plugin -->
<script src="/js/scripts.js"></script><!-- Theme scripts -->

<!-- Initiate flexslider plugin -->
<script type="text/javascript">
    $(document).ready(function($) {
      $('.flexslider').flexslider({
        animation: "fade",
        prevText: "",
        nextText: "",
        directionNav: true
      });
    });
</script>

</body>
</html>
